---
title: "Fmask 4.0: Improved cloud and cloud shadow detection in Landsats 4–8 and Sentinel-2 imagery"
collection: publications
category: manuscripts
permalink: /publication/2019-fmask4
excerpt: 'This paper introduces the Fmask 4 algorithm, which is <b>currently used to generate the quality assessment band for <a href="https://hls.gsfc.nasa.gov"> NASA’s Harmonized Landsat and Sentinel-2 (HLS) data</a> (see <a href="https://doi.org/10.1016/j.rse.2025.114723">this paper</a> for details)</b>.'
date: 2019-09-15
venue: 'Remote Sensing of Environment'
paperurl: 'http://shi-eo.github.io/files/2019-fmask4.pdf'
githuburl: 'https://github.com/GERSL/Fmask'
citation: 'Qiu, Shi, Zhe Zhu, and Binbin He (2019). &quot;Fmask 4.0: Improved cloud and cloud shadow detection in Landsats 4–8 and Sentinel-2 imagery.&quot; <i>Remote Sensing of Environment</i>. 111205.'
---

<b>Abstract:</b> We developed the Function of mask (Fmask) 4.0 algorithm for automated cloud and cloud shadow detection in Landsats 4–8 and Sentinel-2 images. Three major innovative improvements were made as follows: (1) integration of auxiliary data, where Global Surface Water Occurrence (GSWO) data was used to improve the separation of land and water, and a global Digital Elevation Model (DEM) was used to normalize thermal and cirrus bands; (2) development of new cloud probabilities, in which a Haze Optimized Transformation (HOT)-based cloud probability was designed to replace temperature probability for Sentinel-2 images, and cloud probabilities were combined and re-calibrated for different sensors against a global reference dataset; and (3) utilization of spectral-contextual features, where a Spectral-Contextual Snow Index (SCSI) was created for better distinguishing snow/ice from clouds in polar regions, and a morphology-based approach was applied to reduce the commission error in bright land surfaces (e.g., urban/built-up and mountain snow/ice). The Fmask 4.0 algorithm showed higher overall accuracies for Landsats 4–8 imagery than the 3.3 version (Zhu et al., 2015) (92.40% versus 90.73% for Landsats 4–7 and 94.59% versus 93.30% for Landsat 8), and much higher overall accuracies for Sentinel-2 imagery than the 2.5.5 version of the Sen2Cor algorithm (Müller-Wilm et al., 2018) (94.30% versus 87.10%).
